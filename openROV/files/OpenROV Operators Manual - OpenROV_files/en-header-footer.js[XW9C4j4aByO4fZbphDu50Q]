function GlobalHeader(){this.headerDropdownCallbacks={};this.toggleHeaderDropdown=function(e,d){var f=e.getElement(".header-dropdown"),g=e&&""===e.get("data-dropdown-header-open");if(void 0===d||d!==g)TweenMax.killTweensOf(f),g?(e.set("data-dropdown-header-open",null),TweenMax.to(f,.8,{y:"-100%",ease:Circ.easeOut,onComplete:function(){e.removeClass("dropdown-container-active")}})):(this.closeOpenHeaderDropdowns(),e.set("data-dropdown-header-open",""),e.addClass("dropdown-container-active"),TweenMax.to(f,
.6,{y:"0%",ease:Elastic.easeOut.config(1,1)})),(f=Header.headerDropdownCallbacks[e.get("id")])&&f(!g)};this.setupHeaderDropdown=function(e,d,f){f||(f={});e.addEvent("click",function(e){if(!f.unlock||f.unlock())e.preventDefault(),this.toggleHeaderDropdown(d)}.bind(this));window.addEvent("click",function(f){d.contains(f.target)||e.contains(f.target)||this.toggleHeaderDropdown(d,!1)}.bind(this))};this.closeOpenHeaderDropdowns=function(){$$("[data-dropdown-header-open]").each(function(e){this.toggleHeaderDropdown(e,
!1)}.bind(this))};this.showLoggedIn=function(e){when($("loggedInNav"),function(d){var f=e.username.replace(/\s+.*$/,"");$("menuUsername").set("text",f);$("loggedOutNav").hide();d.show()})};this.showLoggedOut=function(){when($("loggedInNav"),function(e){e.hide();$("loggedOutNav").show()})}}window.addEvent("domready",function(){Header.initialize();var e="#menu-button";$("searchDropdown")||(e+=", .search-toggle");$$(e).addEvent("click",function(d){d.stop();$$(".mobile-nav").toggleClass("expanded")})});
var Header=new GlobalHeader;
Header.initialize=function(){this.profileMenuToggle=$("profileMenuToggle");this.profileMenuContainer=$("profileMenuContainer");this.profileMenu=$("profileMenu");window.Auth&&this.initLogin();when(this.profileMenuToggle,function(){this.setupHeaderDropdown(this.profileMenuToggle,this.profileMenuContainer)}.bind(this));window.addEvent("click",function(e){this.searchDropdown&&this.searchDropdown.isVisible()&&e.page.y>=this.searchDropdown.getCoordinates().bottom&&this.hideSearchDropdown()}.bind(this));if(this.searchDropdown=
$("searchDropdown"))this.searchDropdown.store("visible",!1),$$(".search-toggle").addEvent("click",function(e){e.stop();this.searchDropdown.retrieve("visible")?this.hideSearchDropdown():this.showSearchDropdown()}.bind(this))};
Header.initLogin=function(){document.getElement("#header.cartHeader")||(when($("navLogin"),function(e){e.addEvent("click",function(d){var e=!0;Utils.hasUnsavedChanges()&&(e=!1);d.stop();Auth.login({from:"navLogin",message:_js("Logging in will reload the page."),reload:e})})}),when($("navSignup"),function(e){e.addEvent("click",function(d){Utils.hasUnsavedChanges();d.stop();Auth.login({from:"navSignup",message:_js("Registering will reload the page."),reload:!0,register:!0})})}),$$(".js-trigger-language-modal").addEvent("click",
function(e){e.stop();Modal.open({type:"element",href:"#language-modal"})}))};Header.showSearchDropdown=function(){this.searchDropdown.removeClass("search-hidden");this.searchDropdown.store("visible",!0);$("searchForm").focus()};Header.hideSearchDropdown=function(){this.searchDropdown.addClass("search-hidden");this.searchDropdown.store("visible",!1);$("searchForm").blur()};window.addEvent("domready",function(){HeaderLanguages.initialize()});
var HeaderLanguages={initialize:function(){this.languageMenuToggle=$("languageMenuToggle");this.languageMenuContainer=$("languageMenuContainer");this.languageMenu=$("languageMenu");if(Browser.ie7||Browser.ie6){var e=1E3;$$("div").each(function(d,f){d.setStyle("z-index",e);e-=10})}when(this.languageMenuToggle,function(d){Header.setupHeaderDropdown(this.languageMenuToggle,this.languageMenuContainer)}.bind(this));$$(".language-option").addEvent("click",function(d){var e=this.hasClass("machine-translate"),
g=this.getParent("form"),h=g.getChildren(".langidInput");!e&&this.get("data-langid")&&h.set("value",this.get("data-langid"));g.submit();e||d.stop()})}};window.addEvent("domready",function(){$$(".js-slide-toggle").addEvent("click",function(e){e=e.target;var d=e.getNext(".js-slide-drawer");"0px"==d.getStyle("height")?(TweenMax.set(d,{height:"auto"}),TweenMax.from(d,.2,{height:0}),e.addClass("drawer-open")):(TweenMax.to(d,.2,{height:0}),e.removeClass("drawer-open"))})});
FrameModules.add("NewsletterFrameModule",function(){NewsletterFrameModule.initialize()});
var NewsletterFrameModule={initialize:function(){if(this.newsletterDiv=$("newsletterFooterDiv"))this.emailSuccessIcon="fa fa-check-circle",this.emailSuccessText=_js("Success!"),this.emailErrorIcon="fa fa-times",this.emailErrorText=_js("Invalid Email"),this.genericErrorText=_js("An Unknown Error Occurred. Please try again."),this.newsletterIcon=$("newsletterIcon"),this.newsletterText=$("newsletterText"),this.newsletterForm=$("newsletterForm"),this.emailField=$("newsletterEmailInput"),this.newsletterForm.addEvent("submit",
function(e){trackEvent("Footer Newsletter","Subscribe");e.stop();Validation.email(this.emailField.value)?(new Request.AjaxIO("subscribe",{onSuccess:function(d){"object"==typeof d&&(d=d.result);"success"==d?(this.newsletterDiv.removeClass("error"),this.newsletterDiv.addClass("success"),this.newsletterIcon.set("class",this.emailSuccessIcon),this.newsletterText.set("text",this.emailSuccessText),this.newsletterForm.hide()):"email"==d?(this.newsletterDiv.addClass("error"),this.newsletterIcon.set("class",
this.emailErrorIcon),this.newsletterText.set("text",this.emailErrorText)):(this.newsletterDiv.addClass("error"),this.newsletterIcon.set("class",this.emailErrorIcon),this.newsletterText.set("text",this.genericErrorText))}.bind(this)})).send(this.emailField.value):(this.newsletterDiv.addClass("error"),this.newsletterIcon.set("class",this.emailErrorIcon),this.newsletterText.set("text",this.emailErrorText))}.bind(this))}};
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var d;"undefined"!=typeof window?d=window:"undefined"!=typeof global?d=global:"undefined"!=typeof self&&(d=self);d.io=e()}}(function(){return function d(f,g,h){function l(m,r){if(!g[m]){if(!f[m]){var q="function"==typeof require&&require;if(!r&&q)return q(m,!0);if(k)return k(m,!0);throw Error("Cannot find module '"+m+"'");}q=g[m]={exports:{}};f[m][0].call(q.exports,
function(d){var g=f[m][1][d];return l(g?g:d)},q,q.exports,d,f,g,h)}return g[m].exports}for(var k="function"==typeof require&&require,m=0;m<h.length;m++)l(h[m]);return l}({1:[function(d,f,g){f.exports=d("./lib/")},{"./lib/":2}],2:[function(d,f,g){function h(d,f){"object"==typeof d&&(f=d,d=void 0);f=f||{};var g=l(d),h=g.source,k=g.id,y=g.path,y=r[k]&&r[k].nsps[y]&&y==r[k].nsps[y].nsp;f.forceNew||f["force new connection"]||!1===f.multiplex||y?(p("ignoring socket cache for %s",h),h=m(h,f)):(r[k]||(p("new io instance for %s",
h),r[k]=m(h,f)),h=r[k]);return h.socket(g.path)}var l=d("./url"),k=d("socket.io-parser"),m=d("./manager"),p=d("debug")("socket.io-client");f.exports=g=h;var r=g.managers={};g.protocol=k.protocol;g.connect=h;g.Manager=d("./manager");g.Socket=d("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":44}],3:[function(d,f,g){function h(d,f){if(!(this instanceof h))return new h(d,f);d&&"object"==typeof d&&(f=d,d=void 0);f=f||{};f.path=f.path||"/socket.io";this.nsps={};this.subs=
[];this.opts=f;this.reconnection(!1!==f.reconnection);this.reconnectionAttempts(f.reconnectionAttempts||Infinity);this.reconnectionDelay(f.reconnectionDelay||1E3);this.reconnectionDelayMax(f.reconnectionDelayMax||5E3);this.randomizationFactor(f.randomizationFactor||.5);this.backoff=new t({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==f.timeout?2E4:f.timeout);this.readyState="closed";this.uri=d;this.connected=[];this.encoding=!1;
this.packetBuffer=[];this.encoder=new m.Encoder;this.decoder=new m.Decoder;(this.autoConnect=!1!==f.autoConnect)&&this.open()}d("./url");var l=d("engine.io-client"),k=d("./socket");g=d("component-emitter");var m=d("socket.io-parser"),p=d("./on"),r=d("component-bind");d("object-component");var q=d("debug")("socket.io-client:manager"),u=d("indexof"),t=d("backo2");f.exports=h;h.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var d in this.nsps)this.nsps[d].emit.apply(this.nsps[d],arguments)};
h.prototype.updateSocketIds=function(){for(var d in this.nsps)this.nsps[d].id=this.engine.id};g(h.prototype);h.prototype.reconnection=function(d){if(!arguments.length)return this._reconnection;this._reconnection=!!d;return this};h.prototype.reconnectionAttempts=function(d){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=d;return this};h.prototype.reconnectionDelay=function(d){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=d;this.backoff&&
this.backoff.setMin(d);return this};h.prototype.randomizationFactor=function(d){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=d;this.backoff&&this.backoff.setJitter(d);return this};h.prototype.reconnectionDelayMax=function(d){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=d;this.backoff&&this.backoff.setMax(d);return this};h.prototype.timeout=function(d){if(!arguments.length)return this._timeout;this._timeout=d;return this};h.prototype.maybeReconnectOnOpen=
function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};h.prototype.open=h.prototype.connect=function(d){q("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;q("opening %s",this.uri);var f=this.engine=l(this.uri,this.opts),g=this;this.readyState="opening";this.skipReconnect=!1;var h=p(f,"open",function(){g.onopen();d&&d()}),k=p(f,"error",function(f){q("connect_error");g.cleanup();g.readyState="closed";g.emitAll("connect_error",
f);if(d){var h=Error("Connection error");h.data=f;d(h)}else g.maybeReconnectOnOpen()});if(!1!==this._timeout){var m=this._timeout;q("connect attempt will timeout after %d",m);var r=setTimeout(function(){q("connect attempt timed out after %d",m);h.destroy();f.close();f.emit("error","timeout");g.emitAll("connect_timeout",m)},m);this.subs.push({destroy:function(){clearTimeout(r)}})}this.subs.push(h);this.subs.push(k);return this};h.prototype.onopen=function(){q("open");this.cleanup();this.readyState=
"open";this.emit("open");var d=this.engine;this.subs.push(p(d,"data",r(this,"ondata")));this.subs.push(p(this.decoder,"decoded",r(this,"ondecoded")));this.subs.push(p(d,"error",r(this,"onerror")));this.subs.push(p(d,"close",r(this,"onclose")))};h.prototype.ondata=function(d){this.decoder.add(d)};h.prototype.ondecoded=function(d){this.emit("packet",d)};h.prototype.onerror=function(d){q("error",d);this.emitAll("error",d)};h.prototype.socket=function(d){var f=this.nsps[d];if(!f){f=new k(this,d);this.nsps[d]=
f;var g=this;f.on("connect",function(){f.id=g.engine.id;~u(g.connected,f)||g.connected.push(f)})}return f};h.prototype.destroy=function(d){d=u(this.connected,d);~d&&this.connected.splice(d,1);this.connected.length||this.close()};h.prototype.packet=function(d){q("writing packet %j",d);var f=this;f.encoding?f.packetBuffer.push(d):(f.encoding=!0,this.encoder.encode(d,function(d){for(var g=0;g<d.length;g++)f.engine.write(d[g]);f.encoding=!1;f.processPacketQueue()}))};h.prototype.processPacketQueue=function(){if(0<
this.packetBuffer.length&&!this.encoding){var d=this.packetBuffer.shift();this.packet(d)}};h.prototype.cleanup=function(){for(var d;d=this.subs.shift();)d.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};h.prototype.close=h.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};h.prototype.onclose=function(d){q("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",
d);this._reconnection&&!this.skipReconnect&&this.reconnect()};h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var d=this;if(this.backoff.attempts>=this._reconnectionAttempts)q("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var f=this.backoff.duration();q("will wait %dms before reconnect attempt",f);this.reconnecting=!0;var g=setTimeout(function(){d.skipReconnect||(q("attempting reconnect"),d.emitAll("reconnect_attempt",
d.backoff.attempts),d.emitAll("reconnecting",d.backoff.attempts),d.skipReconnect||d.open(function(f){f?(q("reconnect attempt error"),d.reconnecting=!1,d.reconnect(),d.emitAll("reconnect_error",f.data)):(q("reconnect success"),d.onreconnect())}))},f);this.subs.push({destroy:function(){clearTimeout(g)}})}};h.prototype.onreconnect=function(){var d=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",d)}},{"./on":4,"./socket":5,"./url":6,backo2:7,
"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:40,"object-component":41,"socket.io-parser":44}],4:[function(d,f,g){f.exports=function(d,f,g){d.on(f,g);return{destroy:function(){d.removeListener(f,g)}}}},{}],5:[function(d,f,g){function h(d,f){this.io=d;this.nsp=f;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var l=d("socket.io-parser");g=d("component-emitter");
var k=d("to-array"),m=d("./on"),p=d("component-bind"),r=d("debug")("socket.io-client:socket"),q=d("has-binary");f.exports=h;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},t=g.prototype.emit;g(h.prototype);h.prototype.subEvents=function(){if(!this.subs){var d=this.io;this.subs=[m(d,"open",p(this,"onopen")),m(d,"packet",p(this,"onpacket")),m(d,"close",p(this,"onclose"))]}};h.prototype.open=
h.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};h.prototype.send=function(){var d=k(arguments);d.unshift("message");this.emit.apply(this,d);return this};h.prototype.emit=function(d){if(u.hasOwnProperty(d))return t.apply(this,arguments),this;var f=k(arguments),g=l.EVENT;q(f)&&(g=l.BINARY_EVENT);g={type:g,data:f};"function"==typeof f[f.length-1]&&(r("emitting packet with ack id %d",this.ids),this.acks[this.ids]=
f.pop(),g.id=this.ids++);this.connected?this.packet(g):this.sendBuffer.push(g);return this};h.prototype.packet=function(d){d.nsp=this.nsp;this.io.packet(d)};h.prototype.onopen=function(){r("transport is open - connecting");"/"!=this.nsp&&this.packet({type:l.CONNECT})};h.prototype.onclose=function(d){r("close (%s)",d);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",d)};h.prototype.onpacket=function(d){if(d.nsp==this.nsp)switch(d.type){case l.CONNECT:this.onconnect();break;
case l.EVENT:this.onevent(d);break;case l.BINARY_EVENT:this.onevent(d);break;case l.ACK:this.onack(d);break;case l.BINARY_ACK:this.onack(d);break;case l.DISCONNECT:this.ondisconnect();break;case l.ERROR:this.emit("error",d.data)}};h.prototype.onevent=function(d){var f=d.data||[];r("emitting event %j",f);null!=d.id&&(r("attaching ack callback to event"),f.push(this.ack(d.id)));this.connected?t.apply(this,f):this.receiveBuffer.push(f)};h.prototype.ack=function(d){var f=this,g=!1;return function(){if(!g){g=
!0;var h=k(arguments);r("sending ack %j",h);var m=q(h)?l.BINARY_ACK:l.ACK;f.packet({type:m,id:d,data:h})}}};h.prototype.onack=function(d){r("calling ack %s with %j",d.id,d.data);this.acks[d.id].apply(this,d.data);delete this.acks[d.id]};h.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};h.prototype.emitBuffered=function(){var d;for(d=0;d<this.receiveBuffer.length;d++)t.apply(this,this.receiveBuffer[d]);this.receiveBuffer=[];for(d=0;d<
this.sendBuffer.length;d++)this.packet(this.sendBuffer[d]);this.sendBuffer=[]};h.prototype.ondisconnect=function(){r("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};h.prototype.destroy=function(){if(this.subs){for(var d=0;d<this.subs.length;d++)this.subs[d].destroy();this.subs=null}this.io.destroy(this)};h.prototype.close=h.prototype.disconnect=function(){this.connected&&(r("performing disconnect (%s)",this.nsp),this.packet({type:l.DISCONNECT}));this.destroy();
if(this.connected)this.onclose("io client disconnect");return this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":36,"socket.io-parser":44,"to-array":48}],6:[function(d,f,g){(function(g){var l=d("parseuri"),k=d("debug")("socket.io-client:url");f.exports=function(d,f){var r=d;f=f||g.location;null==d&&(d=f.protocol+"//"+f.host);"string"==typeof d&&("/"==d.charAt(0)&&(d="/"==d.charAt(1)?f.protocol+d:f.hostname+d),/^(https?|wss?):\/\//.test(d)||(k("protocol-less url %s",d),
d="undefined"!=typeof f?f.protocol+"//"+d:"https://"+d),k("parse %s",d),r=l(d));r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443"));r.path=r.path||"/";r.id=r.protocol+"://"+r.host+":"+r.port;r.href=r.protocol+"://"+r.host+(f&&f.port==r.port?"":":"+r.port);return r}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:10,parseuri:42}],7:[function(d,f,g){function h(d){d=d||{};this.ms=d.min||100;this.max=d.max||1E4;
this.factor=d.factor||2;this.jitter=0<d.jitter&&1>=d.jitter?d.jitter:0;this.attempts=0}f.exports=h;h.prototype.duration=function(){var d=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var f=Math.random(),g=Math.floor(f*this.jitter*d),d=0==(Math.floor(10*f)&1)?d-g:d+g;return Math.min(d,this.max)|0};h.prototype.reset=function(){this.attempts=0};h.prototype.setMin=function(d){this.ms=d};h.prototype.setMax=function(d){this.max=d};h.prototype.setJitter=function(d){this.jitter=d}},{}],8:[function(d,
f,g){var h=[].slice;f.exports=function(d,f){"string"==typeof f&&(f=d[f]);if("function"!=typeof f)throw Error("bind() requires a function");var g=h.call(arguments,2);return function(){return f.apply(d,g.concat(h.call(arguments)))}}},{}],9:[function(d,f,g){function h(d){if(d){for(var f in h.prototype)d[f]=h.prototype[f];return d}}f.exports=h;h.prototype.on=h.prototype.addEventListener=function(d,f){this._callbacks=this._callbacks||{};(this._callbacks[d]=this._callbacks[d]||[]).push(f);return this};
h.prototype.once=function(d,f){function g(){h.off(d,g);f.apply(this,arguments)}var h=this;this._callbacks=this._callbacks||{};g.fn=f;this.on(d,g);return this};h.prototype.off=h.prototype.removeListener=h.prototype.removeAllListeners=h.prototype.removeEventListener=function(d,f){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var g=this._callbacks[d];if(!g)return this;if(1==arguments.length)return delete this._callbacks[d],this;for(var h,r=0;r<g.length;r++)if(h=
g[r],h===f||h.fn===f){g.splice(r,1);break}return this};h.prototype.emit=function(d){this._callbacks=this._callbacks||{};var f=[].slice.call(arguments,1),g=this._callbacks[d];if(g)for(var g=g.slice(0),h=0,r=g.length;h<r;++h)g[h].apply(this,f);return this};h.prototype.listeners=function(d){this._callbacks=this._callbacks||{};return this._callbacks[d]||[]};h.prototype.hasListeners=function(d){return!!this.listeners(d).length}},{}],10:[function(d,f,g){function h(d){return h.enabled(d)?function(f){f instanceof
Error&&(f=f.stack||f.message);var g=new Date,l=g-(h[d]||g);h[d]=g;f=d+" "+f+" +"+h.humanize(l);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}f.exports=h;h.names=[];h.skips=[];h.enable=function(d){try{localStorage.debug=d}catch(f){}for(var g=(d||"").split(/[\s,]+/),l=g.length,q=0;q<l;q++)d=g[q].replace("*",".*?"),"-"===d[0]?h.skips.push(new RegExp("^"+d.substr(1)+"$")):h.names.push(new RegExp("^"+d+"$"))};h.disable=function(){h.enable("")};
h.humanize=function(d){return 36E5<=d?(d/36E5).toFixed(1)+"h":6E4<=d?(d/6E4).toFixed(1)+"m":1E3<=d?(d/1E3|0)+"s":d+"ms"};h.enabled=function(d){for(var f=0,g=h.skips.length;f<g;f++)if(h.skips[f].test(d))return!1;f=0;for(g=h.names.length;f<g;f++)if(h.names[f].test(d))return!0;return!1};try{window.localStorage&&h.enable(localStorage.debug)}catch(l){}},{}],11:[function(d,f,g){f.exports=d("./lib/")},{"./lib/":12}],12:[function(d,f,g){f.exports=d("./socket");f.exports.parser=d("engine.io-parser")},{"./socket":13,
"engine.io-parser":25}],13:[function(d,f,g){(function(g){function l(d,f){if(!(this instanceof l))return new l(d,f);f=f||{};d&&"object"==typeof d&&(f=d,d=null);d&&(d=u(d),f.host=d.host,f.secure="https"==d.protocol||"wss"==d.protocol,f.port=d.port,d.query&&(f.query=d.query));this.secure=null!=f.secure?f.secure:g.location&&"https:"==location.protocol;if(f.host){var k=f.host.split(":");f.hostname=k.shift();k.length?f.port=k.pop():f.port||(f.port=this.secure?"443":"80")}this.agent=f.agent||!1;this.hostname=
f.hostname||(g.location?location.hostname:"localhost");this.port=f.port||(g.location&&location.port?location.port:this.secure?443:80);this.query=f.query||{};"string"==typeof this.query&&(this.query=v.decode(this.query));this.upgrade=!1!==f.upgrade;this.path=(f.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!f.forceJSONP;this.jsonp=!1!==f.jsonp;this.forceBase64=!!f.forceBase64;this.enablesXDR=!!f.enablesXDR;this.timestampParam=f.timestampParam||"t";this.timestampRequests=f.timestampRequests;
this.transports=f.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=f.policyPort||843;this.rememberUpgrade=f.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=f.onlyBinaryUpgrades;this.pfx=f.pfx||null;this.key=f.key||null;this.passphrase=f.passphrase||null;this.cert=f.cert||null;this.ca=f.ca||null;this.ciphers=f.ciphers||null;this.rejectUnauthorized=f.rejectUnauthorized||null;this.open()}var k=d("./transports"),m=d("component-emitter"),
p=d("debug")("engine.io-client:socket"),r=d("indexof"),q=d("engine.io-parser"),u=d("parseuri"),t=d("parsejson"),v=d("parseqs");f.exports=l;l.priorWebsocketSuccess=!1;m(l.prototype);l.protocol=q.protocol;l.Socket=l;l.Transport=d("./transport");l.transports=d("./transports");l.parser=d("engine.io-parser");l.prototype.createTransport=function(d){p('creating transport "%s"',d);var f=this.query,g={},h;for(h in f)f.hasOwnProperty(h)&&(g[h]=f[h]);g.EIO=q.protocol;g.transport=d;this.id&&(g.sid=this.id);return new k[d]({agent:this.agent,
hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:g,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};l.prototype.open=function(){var d;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&
-1!=this.transports.indexOf("websocket"))d="websocket";else{if(0==this.transports.length){var f=this;setTimeout(function(){f.emit("error","No transports available")},0);return}d=this.transports[0]}this.readyState="opening";try{d=this.createTransport(d)}catch(g){this.transports.shift();this.open();return}d.open();this.setTransport(d)};l.prototype.setTransport=function(d){p("setting transport %s",d.name);var f=this;this.transport&&(p("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());
this.transport=d;d.on("drain",function(){f.onDrain()}).on("packet",function(d){f.onPacket(d)}).on("error",function(d){f.onError(d)}).on("close",function(){f.onClose("transport close")})};l.prototype.probe=function(d){function f(){if(v.onlyBinaryUpgrades){var g=!this.supportsBinary&&v.transport.supportsBinary;u=u||g}u||(p('probe transport "%s" opened',d),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(f){u||("pong"==f.type&&"probe"==f.data?(p('probe transport "%s" pong',d),v.upgrading=
!0,v.emit("upgrading",t),t&&(l.priorWebsocketSuccess="websocket"==t.name,p('pausing current transport "%s"',v.transport.name),v.transport.pause(function(){u||"closed"==v.readyState||(p("changing transport and sending upgrade packet"),r(),v.setTransport(t),t.send([{type:"upgrade"}]),v.emit("upgrade",t),t=null,v.upgrading=!1,v.flush())}))):(p('probe transport "%s" failed',d),f=Error("probe error"),f.transport=t.name,v.emit("upgradeError",f)))}))}function g(){u||(u=!0,r(),t.close(),t=null)}function h(f){var k=
Error("probe error: "+f);k.transport=t.name;g();p('probe transport "%s" failed because of error: %s',d,f);v.emit("upgradeError",k)}function k(){h("transport closed")}function m(){h("socket closed")}function q(d){t&&d.name!=t.name&&(p('"%s" works - aborting "%s"',d.name,t.name),g())}function r(){t.removeListener("open",f);t.removeListener("error",h);t.removeListener("close",k);v.removeListener("close",m);v.removeListener("upgrading",q)}p('probing transport "%s"',d);var t=this.createTransport(d,{probe:1}),
u=!1,v=this;l.priorWebsocketSuccess=!1;t.once("open",f);t.once("error",h);t.once("close",k);this.once("close",m);this.once("upgrading",q);t.open()};l.prototype.onOpen=function(){p("socket open");this.readyState="open";l.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){p("starting upgrade probes");for(var d=0,f=this.upgrades.length;d<f;d++)this.probe(this.upgrades[d])}};l.prototype.onPacket=function(d){if("opening"==
this.readyState||"open"==this.readyState)switch(p('socket receive: type "%s", data "%s"',d.type,d.data),this.emit("packet",d),this.emit("heartbeat"),d.type){case "open":this.onHandshake(t(d.data));break;case "pong":this.setPing();break;case "error":var f=Error("server error");f.code=d.data;this.emit("error",f);break;case "message":this.emit("data",d.data),this.emit("message",d.data)}else p('packet received with socket readyState "%s"',this.readyState)};l.prototype.onHandshake=function(d){this.emit("handshake",
d);this.id=d.sid;this.transport.query.sid=d.sid;this.upgrades=this.filterUpgrades(d.upgrades);this.pingInterval=d.pingInterval;this.pingTimeout=d.pingTimeout;this.onOpen();"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};l.prototype.onHeartbeat=function(d){clearTimeout(this.pingTimeoutTimer);var f=this;f.pingTimeoutTimer=setTimeout(function(){if("closed"!=f.readyState)f.onClose("ping timeout")},d||f.pingInterval+f.pingTimeout)};
l.prototype.setPing=function(){var d=this;clearTimeout(d.pingIntervalTimer);d.pingIntervalTimer=setTimeout(function(){p("writing ping packet - expecting pong within %sms",d.pingTimeout);d.ping();d.onHeartbeat(d.pingTimeout)},d.pingInterval)};l.prototype.ping=function(){this.sendPacket("ping")};l.prototype.onDrain=function(){for(var d=0;d<this.prevBufferLen;d++)if(this.callbackBuffer[d])this.callbackBuffer[d]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);
this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};l.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(p("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};l.prototype.write=l.prototype.send=function(d,f){this.sendPacket("message",d,f);return this};l.prototype.sendPacket=function(d,f,g){"closing"!=
this.readyState&&"closed"!=this.readyState&&(d={type:d,data:f},this.emit("packetCreate",d),this.writeBuffer.push(d),this.callbackBuffer.push(g),this.flush())};l.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){var d=function(){h.once("upgrade",f);h.once("upgradeError",f)},f=function(){h.removeListener("upgrade",f);h.removeListener("upgradeError",f);g()},g=function(){h.onClose("forced close");p("socket closing - telling transport to close");h.transport.close()};this.readyState=
"closing";var h=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?d():g()});else this.upgrading?d():g()}return this};l.prototype.onError=function(d){p("socket error %j",d);l.priorWebsocketSuccess=!1;this.emit("error",d);this.onClose("transport error",d)};l.prototype.onClose=function(d,f){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){p('socket close with reason: "%s"',d);var g=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);
setTimeout(function(){g.writeBuffer=[];g.callbackBuffer=[];g.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",d,f)}};l.prototype.filterUpgrades=function(d){for(var f=[],g=0,h=d.length;g<h;g++)~r(this.transports,d[g])&&f.push(d[g]);return f}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,
debug:22,"engine.io-parser":25,indexof:40,parsejson:32,parseqs:33,parseuri:34}],14:[function(d,f,g){function h(d){this.path=d.path;this.hostname=d.hostname;this.port=d.port;this.secure=d.secure;this.query=d.query;this.timestampParam=d.timestampParam;this.timestampRequests=d.timestampRequests;this.readyState="";this.agent=d.agent||!1;this.socket=d.socket;this.enablesXDR=d.enablesXDR;this.pfx=d.pfx;this.key=d.key;this.passphrase=d.passphrase;this.cert=d.cert;this.ca=d.ca;this.ciphers=d.ciphers;this.rejectUnauthorized=
d.rejectUnauthorized}var l=d("engine.io-parser");d=d("component-emitter");f.exports=h;d(h.prototype);h.timestamps=0;h.prototype.onError=function(d,f){var g=Error(d);g.type="TransportError";g.description=f;this.emit("error",g);return this};h.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};h.prototype.send=
function(d){if("open"==this.readyState)this.write(d);else throw Error("Transport not open");};h.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};h.prototype.onData=function(d){d=l.decodePacket(d,this.socket.binaryType);this.onPacket(d)};h.prototype.onPacket=function(d){this.emit("packet",d)};h.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(d,f,g){(function(f){var l=d("xmlhttprequest"),
k=d("./polling-xhr"),m=d("./polling-jsonp"),p=d("./websocket");g.polling=function(d){var g=!1,p=!1,t=!1!==d.jsonp;f.location&&(p="https:"==location.protocol,(g=location.port)||(g=p?443:80),g=d.hostname!=location.hostname||g!=d.port,p=d.secure!=p);d.xdomain=g;d.xscheme=p;if("open"in new l(d)&&!d.forceJSONP)return new k(d);if(!t)throw Error("JSONP disabled");return new m(d)};g.websocket=p}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,
"./websocket":19,xmlhttprequest:20}],16:[function(d,f,g){(function(g){function l(){}function k(d){m.call(this,d);this.query=this.query||{};u||(g.___eio||(g.___eio=[]),u=g.___eio);this.index=u.length;var f=this;u.push(function(d){f.onData(d)});this.query.j=this.index;g.document&&g.addEventListener&&g.addEventListener("beforeunload",function(){f.script&&(f.script.onerror=l)},!1)}var m=d("./polling"),p=d("component-inherit");f.exports=k;var r=/\n/g,q=/\\n/g,u;p(k,m);k.prototype.supportsBinary=!1;k.prototype.doClose=
function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);m.prototype.doClose.call(this)};k.prototype.doPoll=function(){var d=this,f=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);f.async=!0;f.src=this.uri();f.onerror=function(f){d.onError("jsonp poll error",f)};var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(f,
g);this.script=f;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var d=document.createElement("iframe");document.body.appendChild(d);document.body.removeChild(d)},100)};k.prototype.doWrite=function(d,f){function g(){h();f()}function h(){if(k.iframe)try{k.form.removeChild(k.iframe)}catch(d){k.onError("jsonp polling iframe removal error",d)}try{u=document.createElement('<iframe src="javascript:0" name="'+k.iframeId+'">')}catch(f){u=document.createElement("iframe"),
u.name=k.iframeId,u.src="javascript:0"}u.id=k.iframeId;k.form.appendChild(u);k.iframe=u}var k=this;if(!this.form){var l=document.createElement("form"),m=document.createElement("textarea"),p=this.iframeId="eio_iframe_"+this.index,u;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=p;l.method="POST";l.setAttribute("accept-charset","utf-8");m.name="d";l.appendChild(m);document.body.appendChild(l);this.form=l;this.area=m}this.form.action=this.uri();
h();d=d.replace(q,"\\\n");this.area.value=d.replace(r,"\\n");try{this.form.submit()}catch(J){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==k.iframe.readyState&&g()}:this.iframe.onload=g}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(d,f,g){(function(g){function l(){}function k(d){q.call(this,d);if(g.location){var f="https:"==location.protocol,k=location.port;k||(k=f?443:80);
this.xd=d.hostname!=g.location.hostname||k!=d.port;this.xs=d.secure!=f}}function m(d){this.method=d.method||"GET";this.uri=d.uri;this.xd=!!d.xd;this.xs=!!d.xs;this.async=!1!==d.async;this.data=void 0!=d.data?d.data:null;this.agent=d.agent;this.isBinary=d.isBinary;this.supportsBinary=d.supportsBinary;this.enablesXDR=d.enablesXDR;this.pfx=d.pfx;this.key=d.key;this.passphrase=d.passphrase;this.cert=d.cert;this.ca=d.ca;this.ciphers=d.ciphers;this.rejectUnauthorized=d.rejectUnauthorized;this.create()}
function p(){for(var d in m.requests)m.requests.hasOwnProperty(d)&&m.requests[d].abort()}var r=d("xmlhttprequest"),q=d("./polling"),u=d("component-emitter"),t=d("component-inherit"),v=d("debug")("engine.io-client:polling-xhr");f.exports=k;f.exports.Request=m;t(k,q);k.prototype.supportsBinary=!0;k.prototype.request=function(d){d=d||{};d.uri=this.uri();d.xd=this.xd;d.xs=this.xs;d.agent=this.agent||!1;d.supportsBinary=this.supportsBinary;d.enablesXDR=this.enablesXDR;d.pfx=this.pfx;d.key=this.key;d.passphrase=
this.passphrase;d.cert=this.cert;d.ca=this.ca;d.ciphers=this.ciphers;d.rejectUnauthorized=this.rejectUnauthorized;return new m(d)};k.prototype.doWrite=function(d,f){var g=this.request({method:"POST",data:d,isBinary:"string"!==typeof d&&void 0!==d}),h=this;g.on("success",f);g.on("error",function(d){h.onError("xhr post error",d)});this.sendXhr=g};k.prototype.doPoll=function(){v("xhr poll");var d=this.request(),f=this;d.on("data",function(d){f.onData(d)});d.on("error",function(d){f.onError("xhr poll error",
d)});this.pollXhr=d};u(m.prototype);m.prototype.create=function(){var d={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};d.pfx=this.pfx;d.key=this.key;d.passphrase=this.passphrase;d.cert=this.cert;d.ca=this.ca;d.ciphers=this.ciphers;d.rejectUnauthorized=this.rejectUnauthorized;var f=this.xhr=new r(d),k=this;try{v("xhr open %s: %s",this.method,this.uri);f.open(this.method,this.uri,this.async);this.supportsBinary&&(f.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?
f.setRequestHeader("Content-type","application/octet-stream"):f.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(l){}"withCredentials"in f&&(f.withCredentials=!0);this.hasXDR()?(f.onload=function(){k.onLoad()},f.onerror=function(){k.onError(f.responseText)}):f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status||1223==f.status)k.onLoad();else setTimeout(function(){k.onError(f.status)},0)};v("xhr data %s",this.data);f.send(this.data)}catch(p){setTimeout(function(){k.onError(p)},
0);return}g.document&&(this.index=m.requestsCount++,m.requests[this.index]=this)};m.prototype.onSuccess=function(){this.emit("success");this.cleanup()};m.prototype.onData=function(d){this.emit("data",d);this.onSuccess()};m.prototype.onError=function(d){this.emit("error",d);this.cleanup(!0)};m.prototype.cleanup=function(d){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l;if(d)try{this.xhr.abort()}catch(f){}g.document&&
delete m.requests[this.index];this.xhr=null}};m.prototype.onLoad=function(){var d;try{var f;try{f=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(g){}d="application/octet-stream"===f?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(h){this.onError(h)}if(null!=d)this.onData(d)};m.prototype.hasXDR=function(){return"undefined"!==typeof g.XDomainRequest&&!this.xs&&this.enablesXDR};m.prototype.abort=function(){this.cleanup()};g.document&&(m.requestsCount=0,m.requests=
{},g.attachEvent?g.attachEvent("onunload",p):g.addEventListener&&g.addEventListener("beforeunload",p,!1))}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(d,f,g){function h(d){var f=d&&d.forceBase64;if(!r||f)this.supportsBinary=!1;l.call(this,d)}var l=d("../transport"),k=d("parseqs"),m=d("engine.io-parser");g=d("component-inherit");var p=d("debug")("engine.io-client:polling");
f.exports=h;var r=null!=(new (d("xmlhttprequest"))({xdomain:!1})).responseType;g(h,l);h.prototype.name="polling";h.prototype.doOpen=function(){this.poll()};h.prototype.pause=function(d){function f(){p("paused");g.readyState="paused";d()}var g=this;this.readyState="pausing";if(this.polling||!this.writable){var h=0;this.polling&&(p("we are currently polling - waiting to pause"),h++,this.once("pollComplete",function(){p("pre-pause polling complete");--h||f()}));this.writable||(p("we are currently writing - waiting to pause"),
h++,this.once("drain",function(){p("pre-pause writing complete");--h||f()}))}else f()};h.prototype.poll=function(){p("polling");this.polling=!0;this.doPoll();this.emit("poll")};h.prototype.onData=function(d){var f=this;p("polling got data %s",d);m.decodePayload(d,this.socket.binaryType,function(d,g,h){if("opening"==f.readyState)f.onOpen();if("close"==d.type)return f.onClose(),!1;f.onPacket(d)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():
p('ignoring poll - transport state "%s"',this.readyState))};h.prototype.doClose=function(){function d(){p("writing close packet");f.write([{type:"close"}])}var f=this;"open"==this.readyState?(p("transport open - closing"),d()):(p("transport not open - deferring close"),this.once("open",d))};h.prototype.write=function(d){var f=this;this.writable=!1;var g=function(){f.writable=!0;f.emit("drain")},f=this;m.encodePayload(d,this.supportsBinary,function(d){f.doWrite(d,g)})};h.prototype.uri=function(){var d=
this.query||{},f=this.secure?"https":"http",g="";!1!==this.timestampRequests&&(d[this.timestampParam]=+new Date+"-"+l.timestamps++);this.supportsBinary||d.sid||(d.b64=1);d=k.encode(d);this.port&&("https"==f&&443!=this.port||"http"==f&&80!=this.port)&&(g=":"+this.port);d.length&&(d="?"+d);return f+"://"+this.hostname+g+this.path+d}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,xmlhttprequest:20}],19:[function(d,f,g){function h(d){d&&d.forceBase64&&(this.supportsBinary=
!1);l.call(this,d)}var l=d("../transport"),k=d("engine.io-parser"),m=d("parseqs");g=d("component-inherit");var p=d("debug")("engine.io-client:websocket"),r=d("ws");f.exports=h;g(h,l);h.prototype.name="websocket";h.prototype.supportsBinary=!0;h.prototype.doOpen=function(){if(this.check()){var d=this.uri(),f={agent:this.agent};f.pfx=this.pfx;f.key=this.key;f.passphrase=this.passphrase;f.cert=this.cert;f.ca=this.ca;f.ciphers=this.ciphers;f.rejectUnauthorized=this.rejectUnauthorized;this.ws=new r(d,void 0,
f);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};h.prototype.addEventListeners=function(){var d=this;this.ws.onopen=function(){d.onOpen()};this.ws.onclose=function(){d.onClose()};this.ws.onmessage=function(f){d.onData(f.data)};this.ws.onerror=function(f){d.onError("websocket error",f)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(h.prototype.onData=function(d){var f=this;setTimeout(function(){l.prototype.onData.call(f,
d)},0)});h.prototype.write=function(d){var f=this;this.writable=!1;for(var g=0,h=d.length;g<h;g++)k.encodePacket(d[g],this.supportsBinary,function(d){try{f.ws.send(d)}catch(g){p("websocket closed before onclose event")}});setTimeout(function(){f.writable=!0;f.emit("drain")},0)};h.prototype.onClose=function(){l.prototype.onClose.call(this)};h.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};h.prototype.uri=function(){var d=this.query||{},f=this.secure?"wss":"ws",g="";this.port&&
("wss"==f&&443!=this.port||"ws"==f&&80!=this.port)&&(g=":"+this.port);this.timestampRequests&&(d[this.timestampParam]=+new Date);this.supportsBinary||(d.b64=1);d=m.encode(d);d.length&&(d="?"+d);return f+"://"+this.hostname+g+this.path+d};h.prototype.check=function(){return!!r&&!("__initialize"in r&&this.name===h.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,ws:35}],20:[function(d,f,g){var h=d("has-cors");f.exports=function(d){var f=d.xdomain,
g=d.xscheme;d=d.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!f||h))return new XMLHttpRequest}catch(p){}try{if("undefined"!=typeof XDomainRequest&&!g&&d)return new XDomainRequest}catch(r){}if(!f)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(q){}}},{"has-cors":38}],21:[function(d,f,g){f.exports=function(d,f){var g=function(){};g.prototype=f.prototype;d.prototype=new g;d.prototype.constructor=d}},{}],22:[function(d,f,g){function h(){var d;try{d=localStorage.debug}catch(f){}return d}
g=f.exports=d("./debug");g.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};g.formatArgs=function(){var d=arguments,f=this.useColors;d[0]=(f?"%c":"")+this.namespace+(f?" %c":" ")+d[0]+(f?"%c ":" ")+"+"+g.humanize(this.diff);if(!f)return d;var f="color: "+this.color,d=[d[0],f,"color: inherit"].concat(Array.prototype.slice.call(d,1)),h=0,p=0;d[0].replace(/%[a-z%]/g,function(d){"%%"!==d&&(h++,"%c"===d&&(p=h))});
d.splice(p,0,f);return d};g.save=function(d){try{null==d?localStorage.removeItem("debug"):localStorage.debug=d}catch(f){}};g.load=h;g.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};g.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");g.formatters.j=function(d){return JSON.stringify(d)};
g.enable(h())},{"./debug":23}],23:[function(d,f,g){g=f.exports=function(d){function f(){}function p(){var d=+new Date;p.diff=d-(l||d);p.prev=l;l=p.curr=d;null==p.useColors&&(p.useColors=g.useColors());null==p.color&&p.useColors&&(p.color=g.colors[h++%g.colors.length]);var f=Array.prototype.slice.call(arguments);f[0]=g.coerce(f[0]);"string"!==typeof f[0]&&(f=["%o"].concat(f));var k=0;f[0]=f[0].replace(/%([a-z%])/g,function(d,h){if("%%"===d)return d;k++;var l=g.formatters[h];"function"===typeof l&&
(d=l.call(p,f[k]),f.splice(k,1),k--);return d});"function"===typeof g.formatArgs&&(f=g.formatArgs.apply(p,f));(p.log||g.log||console.log.bind(console)).apply(p,f)}f.enabled=!1;p.enabled=!0;var r=g.enabled(d)?p:f;r.namespace=d;return r};g.coerce=function(d){return d instanceof Error?d.stack||d.message:d};g.disable=function(){g.enable("")};g.enable=function(d){g.save(d);for(var f=(d||"").split(/[\s,]+/),h=f.length,l=0;l<h;l++)f[l]&&(d=f[l].replace(/\*/g,".*?"),"-"===d[0]?g.skips.push(new RegExp("^"+
d.substr(1)+"$")):g.names.push(new RegExp("^"+d+"$")))};g.enabled=function(d){var f,h;f=0;for(h=g.skips.length;f<h;f++)if(g.skips[f].test(d))return!1;f=0;for(h=g.names.length;f<h;f++)if(g.names[f].test(d))return!0;return!1};g.humanize=d("ms");g.names=[];g.skips=[];g.formatters={};var h=0,l},{ms:24}],24:[function(d,f,g){function h(d){if(d=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(d)){var f=parseFloat(d[1]);switch((d[2]||"ms").toLowerCase()){case "years":case "year":case "y":return 315576E5*
f;case "days":case "day":case "d":return 864E5*f;case "hours":case "hour":case "h":return 36E5*f;case "minutes":case "minute":case "m":return 6E4*f;case "seconds":case "second":case "s":return 1E3*f;case "ms":return f}}}function l(d,f,g){if(!(d<f))return d<1.5*f?Math.floor(d/f)+" "+g:Math.ceil(d/f)+" "+g+"s"}f.exports=function(d,f){f=f||{};return"string"==typeof d?h(d):f["long"]?l(d,864E5,"day")||l(d,36E5,"hour")||l(d,6E4,"minute")||l(d,1E3,"second")||d+" ms":864E5<=d?Math.round(d/864E5)+"d":36E5<=
d?Math.round(d/36E5)+"h":6E4<=d?Math.round(d/6E4)+"m":1E3<=d?Math.round(d/1E3)+"s":d+"ms"}},{}],25:[function(d,f,g){(function(f){function l(d,f,h){if(!f)return g.encodeBase64Packet(d,h);var k=new FileReader;k.onload=function(){d.data=k.result;g.encodePacket(d,f,!0,h)};return k.readAsArrayBuffer(d.data)}function k(d,f,g){var h=Array(d.length);g=u(d.length,g);for(var k=function(d,g,k){f(g,function(f,g){h[d]=g;k(f,h)})},l=0;l<d.length;l++)k(l,d[l],g)}var m=d("./keys"),p=d("has-binary"),r=d("arraybuffer.slice"),
q=d("base64-arraybuffer"),u=d("after"),t=d("utf8"),v=navigator.userAgent.match(/Android/i),w=/PhantomJS/i.test(navigator.userAgent),y=v||w;g.protocol=3;var x=g.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},z=m(x),C={type:"error",data:"parser error"},A=d("blob");g.encodePacket=function(d,k,m,p){"function"==typeof k&&(p=k,k=!1);"function"==typeof m&&(p=m,m=null);var q=void 0===d.data?void 0:d.data.buffer||d.data;if(f.ArrayBuffer&&q instanceof ArrayBuffer){if(k){m=d.data;k=new Uint8Array(m);
m=new Uint8Array(1+m.byteLength);m[0]=x[d.type];for(d=0;d<k.length;d++)m[d+1]=k[d];d=p(m.buffer)}else d=g.encodeBase64Packet(d,p);return d}if(A&&q instanceof f.Blob)return k?y?d=l(d,k,p):(k=new Uint8Array(1),k[0]=x[d.type],d=new A([k.buffer,d.data]),d=p(d)):d=g.encodeBase64Packet(d,p),d;if(q&&q.base64)return p("b"+g.packets[d.type]+d.data.data);k=x[d.type];void 0!==d.data&&(k+=m?t.encode(String(d.data)):String(d.data));return p(""+k)};g.encodeBase64Packet=function(d,k){var l="b"+g.packets[d.type];
if(A&&d.data instanceof A){var m=new FileReader;m.onload=function(){var d=m.result.split(",")[1];k(l+d)};return m.readAsDataURL(d.data)}var p;try{p=String.fromCharCode.apply(null,new Uint8Array(d.data))}catch(q){p=new Uint8Array(d.data);for(var r=Array(p.length),t=0;t<p.length;t++)r[t]=p[t];p=String.fromCharCode.apply(null,r)}l+=f.btoa(p);return k(l)};g.decodePacket=function(d,f,h){if("string"==typeof d||void 0===d){if("b"==d.charAt(0))return g.decodeBase64Packet(d.substr(1),f);if(h)try{d=t.decode(d)}catch(k){return C}h=
d.charAt(0);return Number(h)==h&&z[h]?1<d.length?{type:z[h],data:d.substring(1)}:{type:z[h]}:C}h=(new Uint8Array(d))[0];d=r(d,1);A&&"blob"===f&&(d=new A([d]));return{type:z[h],data:d}};g.decodeBase64Packet=function(d,g){var k=z[d.charAt(0)];if(!f.ArrayBuffer)return{type:k,data:{base64:!0,data:d.substr(1)}};var l=q.decode(d.substr(1));"blob"===g&&A&&(l=new A([l]));return{type:k,data:l}};g.encodePayload=function(d,f,h){"function"==typeof f&&(h=f,f=null);var l=p(d);if(f&&l)return A&&!y?g.encodePayloadAsBlob(d,
h):g.encodePayloadAsArrayBuffer(d,h);if(!d.length)return h("0:");k(d,function(d,h){g.encodePacket(d,l?f:!1,!0,function(d){h(null,d.length+":"+d)})},function(d,f){return h(f.join(""))})};g.decodePayload=function(d,f,h){if("string"!=typeof d)return g.decodePayloadAsBinary(d,f,h);"function"===typeof f&&(h=f,f=null);var k;if(""==d)return h(C,0,1);k="";for(var l,m,p=0,q=d.length;p<q;p++)if(m=d.charAt(p),":"!=m)k+=m;else{if(""==k||k!=(l=Number(k)))return h(C,0,1);m=d.substr(p+1,l);if(k!=m.length)return h(C,
0,1);if(m.length){k=g.decodePacket(m,f,!0);if(C.type==k.type&&C.data==k.data)return h(C,0,1);if(!1===h(k,p+l,q))return}p+=l;k=""}if(""!=k)return h(C,0,1)};g.encodePayloadAsArrayBuffer=function(d,f){if(!d.length)return f(new ArrayBuffer(0));k(d,function(d,f){g.encodePacket(d,!0,!0,function(d){return f(null,d)})},function(d,g){var h=g.reduce(function(d,f){var g;g="string"===typeof f?f.length:f.byteLength;return d+g.toString().length+g+2},0),k=new Uint8Array(h),l=0;g.forEach(function(d){var f="string"===
typeof d,g=d;if(f){for(var g=new Uint8Array(d.length),h=0;h<d.length;h++)g[h]=d.charCodeAt(h);g=g.buffer}f?k[l++]=0:k[l++]=1;d=g.byteLength.toString();for(h=0;h<d.length;h++)k[l++]=parseInt(d[h]);k[l++]=255;g=new Uint8Array(g);for(h=0;h<g.length;h++)k[l++]=g[h]});return f(k.buffer)})};g.encodePayloadAsBlob=function(d,f){k(d,function(d,f){g.encodePacket(d,!0,!0,function(d){var g=new Uint8Array(1);g[0]=1;if("string"===typeof d){for(var h=new Uint8Array(d.length),k=0;k<d.length;k++)h[k]=d.charCodeAt(k);
d=h.buffer;g[0]=0}for(var h=(d instanceof ArrayBuffer?d.byteLength:d.size).toString(),l=new Uint8Array(h.length+1),k=0;k<h.length;k++)l[k]=parseInt(h[k]);l[h.length]=255;A&&(d=new A([g.buffer,l.buffer,d]),f(null,d))})},function(d,g){return f(new A(g))})};g.decodePayloadAsBinary=function(d,f,h){"function"===typeof f&&(h=f,f=null);for(var k=[],l=!1;0<d.byteLength;){for(var m=new Uint8Array(d),p=0===m[0],q="",t=1;255!=m[t];t++){if(310<q.length){l=!0;break}q+=m[t]}if(l)return h(C,0,1);d=r(d,2+q.length);
q=parseInt(q);m=r(d,0,q);if(p)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(u){for(p=new Uint8Array(m),m="",t=0;t<p.length;t++)m+=String.fromCharCode(p[t])}k.push(m);d=r(d,q)}var v=k.length;k.forEach(function(d,k){h(g.decodePacket(d,f,!0),k,v)})}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":36,utf8:31}],26:[function(d,f,g){f.exports=Object.keys||function(d){var f=
[],g=Object.prototype.hasOwnProperty,m;for(m in d)g.call(d,m)&&f.push(m);return f}},{}],27:[function(d,f,g){function h(){}f.exports=function(d,f,g){function p(d,h){if(0>=p.count)throw Error("after called too many times");--p.count;d?(r=!0,f(d),f=g):0!==p.count||r||f(null,h)}var r=!1;g=g||h;p.count=d;return 0===d?f():p}},{}],28:[function(d,f,g){f.exports=function(d,f,g){var m=d.byteLength;f=f||0;g=g||m;if(d.slice)return d.slice(f,g);0>f&&(f+=m);0>g&&(g+=m);g>m&&(g=m);if(f>=m||f>=g||0===m)return new ArrayBuffer(0);
d=new Uint8Array(d);for(var m=new Uint8Array(g-f),p=0;f<g;f++,p++)m[p]=d[f];return m.buffer}},{}],29:[function(d,f,g){(function(d){g.encode=function(f){f=new Uint8Array(f);var g,m=f.length,p="";for(g=0;g<m;g+=3)p+=d[f[g]>>2],p+=d[(f[g]&3)<<4|f[g+1]>>4],p+=d[(f[g+1]&15)<<2|f[g+2]>>6],p+=d[f[g+2]&63];2===m%3?p=p.substring(0,p.length-1)+"=":1===m%3&&(p=p.substring(0,p.length-2)+"==");return p};g.decode=function(f){var g=.75*f.length,m=f.length,p=0,r,q,u,t;"="===f[f.length-1]&&(g--,"="===f[f.length-2]&&
g--);for(var v=new ArrayBuffer(g),w=new Uint8Array(v),g=0;g<m;g+=4)r=d.indexOf(f[g]),q=d.indexOf(f[g+1]),u=d.indexOf(f[g+2]),t=d.indexOf(f[g+3]),w[p++]=r<<2|q>>4,w[p++]=(q&15)<<4|u>>2,w[p++]=(u&3)<<6|t&63;return v}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(d,f,g){(function(d){function g(d){for(var f=0;f<d.length;f++){var h=d[f];if(h.buffer instanceof ArrayBuffer){var k=h.buffer;if(h.byteLength!==k.byteLength){var l=new Uint8Array(h.byteLength);l.set(new Uint8Array(k,
h.byteOffset,h.byteLength));k=l.buffer}d[f]=k}}}function k(d,f){f=f||{};var h=new p;g(d);for(var k=0;k<d.length;k++)h.append(d[k]);return f.type?h.getBlob(f.type):h.getBlob()}function m(d,f){g(d);return new Blob(d,f||{})}var p=d.BlobBuilder||d.WebKitBlobBuilder||d.MSBlobBuilder||d.MozBlobBuilder,r;try{r=2===(new Blob(["hi"])).size}catch(q){r=!1}var u;if(u=r)try{u=2===(new Blob([new Uint8Array([1,2])])).size}catch(t){u=!1}var v=p&&p.prototype.append&&p.prototype.getBlob;d=r?u?d.Blob:m:v?k:void 0;f.exports=
d}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],31:[function(d,f,g){(function(d){(function(l){function k(d){for(var f=[],g=0,h=d.length,k,l;g<h;)k=d.charCodeAt(g++),55296<=k&&56319>=k&&g<h?(l=d.charCodeAt(g++),56320==(l&64512)?f.push(((k&1023)<<10)+(l&1023)+65536):(f.push(k),g--)):f.push(k);return f}function m(d){if(55296<=d&&57343>=d)throw Error("Lone surrogate U+"+d.toString(16).toUpperCase()+" is not a scalar value");}function p(){if(x>=y)throw Error("Invalid byte index");
var d=w[x]&255;x++;if(128==(d&192))return d&63;throw Error("Invalid continuation byte");}function r(){var d,f,g,h;if(x>y)throw Error("Invalid byte index");if(x==y)return!1;d=w[x]&255;x++;if(0==(d&128))return d;if(192==(d&224)){f=p();d=(d&31)<<6|f;if(128<=d)return d;throw Error("Invalid continuation byte");}if(224==(d&240)){f=p();g=p();d=(d&15)<<12|f<<6|g;if(2048<=d)return m(d),d;throw Error("Invalid continuation byte");}if(240==(d&248)&&(f=p(),g=p(),h=p(),d=(d&15)<<18|f<<12|g<<6|h,65536<=d&&1114111>=
d))return d;throw Error("Invalid UTF-8 detected");}var q="object"==typeof g&&g,u="object"==typeof f&&f&&f.exports==q&&f,t="object"==typeof d&&d;if(t.global===t||t.window===t)l=t;var v=String.fromCharCode,w,y,x,t={version:"2.0.0",encode:function(d){d=k(d);for(var f=d.length,g=-1,h,l="";++g<f;){h=d[g];if(0==(h&4294967168))h=v(h);else{var p="";0==(h&4294965248)?p=v(h>>6&31|192):0==(h&4294901760)?(m(h),p=v(h>>12&15|224),p+=v(h>>6&63|128)):0==(h&4292870144)&&(p=v(h>>18&7|240),p+=v(h>>12&63|128),p+=v(h>>
6&63|128));h=p+=v(h&63|128)}l+=h}return l},decode:function(d){w=k(d);y=w.length;x=0;d=[];for(var f;!1!==(f=r());)d.push(f);f=d.length;for(var g=-1,h,l="";++g<f;)h=d[g],65535<h&&(h-=65536,l+=v(h>>>10&1023|55296),h=56320|h&1023),l+=v(h);return l}};if(q&&!q.nodeType)if(u)u.exports=t;else{l={}.hasOwnProperty;for(var z in t)l.call(t,z)&&(q[z]=t[z])}else l.utf8=t})(this)}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],32:[function(d,f,g){(function(d){var g=/^[\],:{}\s]*$/,
k=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,m=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,r=/^\s+/,q=/\s+$/;f.exports=function(f){if("string"!=typeof f||!f)return null;f=f.replace(r,"").replace(q,"");if(d.JSON&&JSON.parse)return JSON.parse(f);if(g.test(f.replace(k,"@").replace(m,"]").replace(p,"")))return(new Function("return "+f))()}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],33:[function(d,f,g){g.encode=function(d){var f=
"",g;for(g in d)d.hasOwnProperty(g)&&(f.length&&(f+="&"),f+=encodeURIComponent(g)+"="+encodeURIComponent(d[g]));return f};g.decode=function(d){var f={};d=d.split("&");for(var g=0,m=d.length;g<m;g++){var p=d[g].split("=");f[decodeURIComponent(p[0])]=decodeURIComponent(p[1])}return f}},{}],34:[function(d,f,g){var h=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
l="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");f.exports=function(d){var f=d,g=d.indexOf("["),r=d.indexOf("]");-1!=g&&-1!=r&&(d=d.substring(0,g)+d.substring(g,r).replace(/:/g,";")+d.substring(r,d.length));d=h.exec(d||"");for(var q={},u=14;u--;)q[l[u]]=d[u]||"";-1!=g&&-1!=r&&(q.source=f,q.host=q.host.substring(1,q.host.length-1).replace(/;/g,":"),q.authority=q.authority.replace("[","").replace("]","").replace(/;/g,":"),q.ipv6uri=
!0);return q}},{}],35:[function(d,f,g){function h(d,f,g){return f?new l(d,f):new l(d)}d=function(){return this}();var l=d.WebSocket||d.MozWebSocket;f.exports=l?h:null;l&&(h.prototype=l.prototype)},{}],36:[function(d,f,g){(function(g){var l=d("isarray");f.exports=function(d){function f(d){if(!d)return!1;if(g.Buffer&&g.Buffer.isBuffer(d)||g.ArrayBuffer&&d instanceof ArrayBuffer||g.Blob&&d instanceof Blob||g.File&&d instanceof File)return!0;if(l(d))for(var k=0;k<d.length;k++){if(f(d[k]))return!0}else if(d&&
"object"==typeof d)for(k in d.toJSON&&(d=d.toJSON()),d)if(Object.prototype.hasOwnProperty.call(d,k)&&f(d[k]))return!0;return!1}return f(d)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:37}],37:[function(d,f,g){f.exports=Array.isArray||function(d){return"[object Array]"==Object.prototype.toString.call(d)}},{}],38:[function(d,f,g){d=d("global");try{f.exports="XMLHttpRequest"in d&&"withCredentials"in new d.XMLHttpRequest}catch(h){f.exports=!1}},{global:39}],
39:[function(d,f,g){f.exports=function(){return this}()},{}],40:[function(d,f,g){var h=[].indexOf;f.exports=function(d,f){if(h)return d.indexOf(f);for(var g=0;g<d.length;++g)if(d[g]===f)return g;return-1}},{}],41:[function(d,f,g){var h=Object.prototype.hasOwnProperty;g.keys=Object.keys||function(d){var f=[],g;for(g in d)h.call(d,g)&&f.push(g);return f};g.values=function(d){var f=[],g;for(g in d)h.call(d,g)&&f.push(d[g]);return f};g.merge=function(d,f){for(var g in f)h.call(f,g)&&(d[g]=f[g]);return d};
g.length=function(d){return g.keys(d).length};g.isEmpty=function(d){return 0==g.length(d)}},{}],42:[function(d,f,g){var h=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,l="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");f.exports=function(d){d=h.exec(d||
"");for(var f={},g=14;g--;)f[l[g]]=d[g]||"";return f}},{}],43:[function(d,f,g){(function(f){var l=d("isarray"),k=d("./is-buffer");g.deconstructPacket=function(d){function f(d){if(!d)return d;if(k(d)){var h={_placeholder:!0,num:g.length};g.push(d);return h}if(l(d)){for(var h=Array(d.length),m=0;m<d.length;m++)h[m]=f(d[m]);return h}if("object"==typeof d&&!(d instanceof Date)){h={};for(m in d)h[m]=f(d[m]);return h}return d}var g=[];d.data=f(d.data);d.attachments=g.length;return{packet:d,buffers:g}};
g.reconstructPacket=function(d,f){function g(d){if(d&&d._placeholder)return f[d.num];if(l(d))for(var h=0;h<d.length;h++)d[h]=g(d[h]);else if(d&&"object"==typeof d)for(h in d)d[h]=g(d[h]);return d}d.data=g(d.data);d.attachments=void 0;return d};g.removeBlobs=function(d,g){function r(d,m,w){if(!d)return d;if(f.Blob&&d instanceof Blob||f.File&&d instanceof File){q++;var y=new FileReader;y.onload=function(){w?w[m]=this.result:u=this.result;--q||g(u)};y.readAsArrayBuffer(d)}else if(l(d))for(y=0;y<d.length;y++)r(d[y],
y,d);else if(d&&"object"==typeof d&&!k(d))for(y in d)r(d[y],y,d)}var q=0,u=d;r(u);q||g(u)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":45,isarray:46}],44:[function(d,f,g){function h(){}function l(d){var f,h=!1;f=""+d.type;if(g.BINARY_EVENT==d.type||g.BINARY_ACK==d.type)f+=d.attachments,f+="-";d.nsp&&"/"!=d.nsp&&(h=!0,f+=d.nsp);null!=d.id&&(h&&(f+=",",h=!1),f+=d.id);null!=d.data&&(h&&(f+=","),f+=q.stringify(d.data));r("encoded %j as %s",d,f);return f}
function k(d,f){u.removeBlobs(d,function(d){var g=u.deconstructPacket(d);d=l(g.packet);g=g.buffers;g.unshift(d);f(g)})}function m(){this.reconstructor=null}function p(d){this.reconPack=d;this.buffers=[]}var r=d("debug")("socket.io-parser"),q=d("json3");d("isarray");f=d("component-emitter");var u=d("./binary"),t=d("./is-buffer");g.protocol=4;g.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");g.CONNECT=0;g.DISCONNECT=1;g.EVENT=2;g.ACK=3;g.ERROR=4;g.BINARY_EVENT=5;g.BINARY_ACK=
6;g.Encoder=h;g.Decoder=m;h.prototype.encode=function(d,f){r("encoding packet %j",d);if(g.BINARY_EVENT==d.type||g.BINARY_ACK==d.type)k(d,f);else{var h=l(d);f([h])}};f(m.prototype);m.prototype.add=function(d){if("string"==typeof d){a:{var f={},h=0;f.type=Number(d.charAt(0));if(null==g.types[f.type])d={type:g.ERROR,data:"parser error"};else{if(g.BINARY_EVENT==f.type||g.BINARY_ACK==f.type){for(var k="";"-"!=d.charAt(++h)&&(k+=d.charAt(h),h!=d.length););if(k!=Number(k)||"-"!=d.charAt(h))throw Error("Illegal attachments");
f.attachments=Number(k)}if("/"==d.charAt(h+1))for(f.nsp="";++h;){k=d.charAt(h);if(","==k)break;f.nsp+=k;if(h==d.length)break}else f.nsp="/";k=d.charAt(h+1);if(""!==k&&Number(k)==k){for(f.id="";++h;){k=d.charAt(h);if(null==k||Number(k)!=k){--h;break}f.id+=d.charAt(h);if(h==d.length)break}f.id=Number(f.id)}if(d.charAt(++h))try{f.data=q.parse(d.substr(h))}catch(l){d={type:g.ERROR,data:"parser error"};break a}r("decoded %s as %j",d,f);d=f}}g.BINARY_EVENT==d.type||g.BINARY_ACK==d.type?(this.reconstructor=
new p(d),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",d)):this.emit("decoded",d)}else if(t(d)||d.base64)if(this.reconstructor){if(d=this.reconstructor.takeBinaryData(d))this.reconstructor=null,this.emit("decoded",d)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+d);};m.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};p.prototype.takeBinaryData=function(d){this.buffers.push(d);
return this.buffers.length==this.reconPack.attachments?(d=u.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),d):null};p.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":43,"./is-buffer":45,"component-emitter":9,debug:10,isarray:46,json3:47}],45:[function(d,f,g){(function(d){f.exports=function(f){return d.Buffer&&d.Buffer.isBuffer(f)||d.ArrayBuffer&&f instanceof ArrayBuffer}}).call(this,"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{})},{}],46:[function(d,f,g){f.exports=d(37)},{}],47:[function(d,f,g){(function(d){function f(d){if(f[d]!==r)return f[d];var g;if("bug-string-char-index"==d)g="a"!="a"[0];else if("json"==d)g=f("json-stringify")&&f("json-parse");else{var h;if("json-stringify"==d){g=u.stringify;var m="function"==typeof g&&t;if(m){(h=function(){return 1}).toJSON=h;try{m="0"===g(0)&&"0"===g(new Number)&&'""'==g(new String)&&g(k)===r&&g(r)===r&&g()===r&&"1"===g(h)&&"[1]"==g([h])&&"[null]"==g([r])&&
"null"==g(null)&&"[null,null,null]"==g([r,k,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==g({a:[h,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===g(null,h)&&"[\n 1,\n 2\n]"==g([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==g(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==g(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==g(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==g(new Date(-1))}catch(p){m=!1}}g=m}if("json-parse"==d){g=u.parse;if("function"==typeof g)try{if(0===g("0")&&
!g(!1)){h=g('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var q=5==h.a.length&&1===h.a[0];if(q){try{q=!g('"\t"')}catch(v){}if(q)try{q=1!==g("01")}catch(w){}if(q)try{q=1!==g("1.")}catch(x){}}}}catch(y){q=!1}g=q}}return f[d]=!!g}var k={}.toString,m,p,r,q="object"==typeof JSON&&JSON,u="object"==typeof g&&g&&!g.nodeType&&g;u&&q?(u.stringify=q.stringify,u.parse=q.parse):u=d.JSON=q||{};var t=new Date(-0xc782b5b800cec);try{t=-109252==t.getUTCFullYear()&&0===t.getUTCMonth()&&1===t.getUTCDate()&&10==
t.getUTCHours()&&37==t.getUTCMinutes()&&6==t.getUTCSeconds()&&708==t.getUTCMilliseconds()}catch(v){}if(!f("json")){var w=f("bug-string-char-index");if(!t)var y=Math.floor,x=[0,31,59,90,120,151,181,212,243,273,304,334],z=function(d,f){return x[f]+365*(d-1970)+y((d-1969+(f=+(1<f)))/4)-y((d-1901+f)/100)+y((d-1601+f)/400)};(m={}.hasOwnProperty)||(m=function(d){var f={},g;(f.__proto__=null,f.__proto__={toString:1},f).toString!=k?m=function(d){var f=this.__proto__;d=d in(this.__proto__=null,this);this.__proto__=
f;return d}:(g=f.constructor,m=function(d){var f=(this.constructor||g).prototype;return d in this&&!(d in f&&this[d]===f[d])});f=null;return m.call(this,d)});var C={"boolean":1,number:1,string:1,undefined:1};p=function(d,f){var g=0,h,l,q;(h=function(){this.valueOf=0}).prototype.valueOf=0;l=new h;for(q in l)m.call(l,q)&&g++;h=l=null;g?p=2==g?function(d,f){var g={},h="[object Function]"==k.call(d),l;for(l in d)h&&"prototype"==l||m.call(g,l)||!(g[l]=1)||!m.call(d,l)||f(l)}:function(d,f){var g="[object Function]"==
k.call(d),h,l;for(h in d)g&&"prototype"==h||!m.call(d,h)||(l="constructor"===h)||f(h);(l||m.call(d,h="constructor"))&&f(h)}:(l="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),p=function(d,f){var g="[object Function]"==k.call(d),h,n;if(n=!g&&"function"!=typeof d.constructor)n=typeof d.hasOwnProperty,n="object"==n?!!d.hasOwnProperty:!C[n];n=n?d.hasOwnProperty:m;for(h in d)g&&"prototype"==h||!n.call(d,h)||f(h);for(g=l.length;h=l[--g];n.call(d,
h)&&f(h));});return p(d,f)};if(!f("json-stringify")){var A={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},G=function(d,f){return("000000"+(f||0)).slice(-d)},J=function(d){var f='"',g=0,h=d.length,k=10<h&&w,l;for(k&&(l=d.split(""));g<h;g++){var m=d.charCodeAt(g);switch(m){case 8:case 9:case 10:case 12:case 13:case 34:case 92:f+=A[m];break;default:if(32>m){f+="\\u00"+G(2,m.toString(16));break}f+=k?l[g]:w?d.charAt(g):d[g]}}return f+'"'},B=function(d,f,g,h,l,q,t){var u,v,w,n,x,A,C,D,
F;try{u=f[d]}catch(E){}if("object"==typeof u&&u)if(v=k.call(u),"[object Date]"!=v||m.call(u,"toJSON"))"function"==typeof u.toJSON&&("[object Number]"!=v&&"[object String]"!=v&&"[object Array]"!=v||m.call(u,"toJSON"))&&(u=u.toJSON(d));else if(u>-1/0&&u<1/0){if(z){n=y(u/864E5);for(v=y(n/365.2425)+1970-1;z(v+1,0)<=n;v++);for(w=y((n-z(v,0))/30.42);z(v,w+1)<=n;w++);n=1+n-z(v,w);x=(u%864E5+864E5)%864E5;A=y(x/36E5)%24;C=y(x/6E4)%60;D=y(x/1E3)%60;x%=1E3}else v=u.getUTCFullYear(),w=u.getUTCMonth(),n=u.getUTCDate(),
A=u.getUTCHours(),C=u.getUTCMinutes(),D=u.getUTCSeconds(),x=u.getUTCMilliseconds();u=(0>=v||1E4<=v?(0>v?"-":"+")+G(6,0>v?-v:v):G(4,v))+"-"+G(2,w+1)+"-"+G(2,n)+"T"+G(2,A)+":"+G(2,C)+":"+G(2,D)+"."+G(3,x)+"Z"}else u=null;g&&(u=g.call(f,d,u));if(null===u)return"null";v=k.call(u);if("[object Boolean]"==v)return""+u;if("[object Number]"==v)return u>-1/0&&u<1/0?""+u:"null";if("[object String]"==v)return J(""+u);if("object"==typeof u){for(d=t.length;d--;)if(t[d]===u)throw TypeError();t.push(u);F=[];f=q;
q+=l;if("[object Array]"==v){w=0;for(d=u.length;w<d;w++)v=B(w,u,g,h,l,q,t),F.push(v===r?"null":v);d=F.length?l?"[\n"+q+F.join(",\n"+q)+"\n"+f+"]":"["+F.join(",")+"]":"[]"}else p(h||u,function(d){var f=B(d,u,g,h,l,q,t);f!==r&&F.push(J(d)+":"+(l?" ":"")+f)}),d=F.length?l?"{\n"+q+F.join(",\n"+q)+"\n"+f+"}":"{"+F.join(",")+"}":"{}";t.pop();return d}};u.stringify=function(d,f,g){var h,l,m,p;if("function"==typeof f||"object"==typeof f&&f)if("[object Function]"==(p=k.call(f)))l=f;else if("[object Array]"==
p){m={};for(var q=0,r=f.length,t;q<r;t=f[q++],(p=k.call(t),"[object String]"==p||"[object Number]"==p)&&(m[t]=1));}if(g)if("[object Number]"==(p=k.call(g))){if(0<(g-=g%1))for(h="",10<g&&(g=10);h.length<g;h+=" ");}else"[object String]"==p&&(h=10>=g.length?g:g.slice(0,10));return B("",(t={},t[""]=d,t),l,m,h,"",[])}}if(!f("json-parse")){var F=String.fromCharCode,D={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},E,P,H=function(){E=P=null;throw SyntaxError();},Q=function(){for(var d=
P,f=d.length,g,h,k,l,m;E<f;)switch(m=d.charCodeAt(E),m){case 9:case 10:case 13:case 32:E++;break;case 123:case 125:case 91:case 93:case 58:case 44:return g=w?d.charAt(E):d[E],E++,g;case 34:g="@";for(E++;E<f;)if(m=d.charCodeAt(E),32>m)H();else if(92==m)switch(m=d.charCodeAt(++E),m){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:g+=D[m];E++;break;case 117:h=++E;for(k=E+4;E<k;E++)m=d.charCodeAt(E),48<=m&&57>=m||97<=m&&102>=m||65<=m&&70>=m||H();g+=F("0x"+d.slice(h,E));break;default:H()}else{if(34==
m)break;m=d.charCodeAt(E);for(h=E;32<=m&&92!=m&&34!=m;)m=d.charCodeAt(++E);g+=d.slice(h,E)}if(34==d.charCodeAt(E))return E++,g;H();default:h=E;45==m&&(l=!0,m=d.charCodeAt(++E));if(48<=m&&57>=m){for(48==m&&(m=d.charCodeAt(E+1),48<=m&&57>=m)&&H();E<f&&(m=d.charCodeAt(E),48<=m&&57>=m);E++);if(46==d.charCodeAt(E)){for(k=++E;k<f&&(m=d.charCodeAt(k),48<=m&&57>=m);k++);k==E&&H();E=k}m=d.charCodeAt(E);if(101==m||69==m){m=d.charCodeAt(++E);43!=m&&45!=m||E++;for(k=E;k<f&&(m=d.charCodeAt(k),48<=m&&57>=m);k++);
k==E&&H();E=k}return+d.slice(h,E)}l&&H();if("true"==d.slice(E,E+4))return E+=4,!0;if("false"==d.slice(E,E+5))return E+=5,!1;if("null"==d.slice(E,E+4))return E+=4,null;H()}return"$"},S=function(d){var f,g;"$"==d&&H();if("string"==typeof d){if("@"==(w?d.charAt(0):d[0]))return d.slice(1);if("["==d){for(f=[];;g||(g=!0)){d=Q();if("]"==d)break;g&&(","==d?(d=Q(),"]"==d&&H()):H());","==d&&H();f.push(S(d))}return f}if("{"==d){for(f={};;g||(g=!0)){d=Q();if("}"==d)break;g&&(","==d?(d=Q(),"}"==d&&H()):H());","!=
d&&"string"==typeof d&&"@"==(w?d.charAt(0):d[0])&&":"==Q()||H();f[d.slice(1)]=S(Q())}return f}H()}return d},T=function(d,f,g){g=U(d,f,g);g===r?delete d[f]:d[f]=g},U=function(d,f,g){var h=d[f],l;if("object"==typeof h&&h)if("[object Array]"==k.call(h))for(l=h.length;l--;)T(h,l,g);else p(h,function(d){T(h,d,g)});return g.call(d,f,h)};u.parse=function(d,f){var g,h;E=0;P=""+d;g=S(Q());"$"!=Q()&&H();E=P=null;return f&&"[object Function]"==k.call(f)?U((h={},h[""]=g,h),"",f):g}}}})(this)},{}],48:[function(d,
f,g){f.exports=function(d,f){for(var g=[],m=(f=f||0)||0;m<d.length;m++)g[m-f]=d[m];return g}},{}]},{},[1])(1)});
App.realtimeEnabled&&function(){function e(){return parseInt(u.get("text"),10)}function d(d){0>d&&(d=0);u.toggleClass("active",0<d);u.set("text",d);when(t,function(e){e.toggleClass("read",0==d);e.toggleClass("fa-bell-o",0==d);e.toggleClass("unread",0!=d);e.toggleClass("fa-bell",0!=d)});when(x,function(e){e.set("text",d);e.toggleClass("hidden",0==d);w&&w.toggleClass("disabled",0==d)}.bind(this))}function f(d){d.preventDefault()}function g(d,e){d.toggleClass("read",e).toggleClass("unread",!e)}function h(d){var e=
this.get("data-notificationid"),f=this.getChildren("a > i[.notification-icon]")[0];f.hasClass("read")||(this.getChildren("a")[0].get("href")&&this.set("data-leaving-page","data-leaving-page"),(new Request.API_2_0("notifications?ids="+e,{method:"GET",onSuccess:function(d){f.hasClass("unread")?(g(f,!0),d=f.getParent("li"),d.hasClass("unread")&&g(d,!0),when(q,function(d){m([e])}.bind(this))):when(y,function(d){if(d=d.getChildren('ul > li[data-notificationid="'+e+'"]')[0])d=d.getChildren("a > i[.notification-icon]")[0],
g(d,!0),d=d.getParent("li"),d.hasClass("unread")&&g(d,!0)})}.bind(this)})).send())}function l(){(new Request.API_2_0("notifications/all",{method:"DELETE",onSuccess:function(d){m()}.bind(this)})).send()}function k(d){return d&&null===d.get("data-leaving-page")}function m(f){if("undefined"===typeof f)Header.toggleHeaderDropdown(r,!1),d(0),when(q,function(d){d.getElements("li[data-notificationid]").filter(k).each(function(d){d.destroy()})}.bind(this)),when(y,function(d){d.getChildren("ul > li[data-notificationid] > a > i[.notification-icon]").each(function(d){g(d,
!0);d=d.getParent("li");d.hasClass("unread")&&g(d,!0)});w.addClass("hideThis")});else{var h=e();f.forEach(function(d){var e=q.getChildren('li[data-notificationid="'+d+'"]')[0];document.title=C;k(e)&&e.destroy();when(y,function(e){if(e=e.querySelector('[data-notificationid="'+d+'"]'))if(e=e.getElement(".notification-icon"))e.addClass("read"),e.removeClass("unread")});h--});0==h&&Header.toggleHeaderDropdown(r,!1);d(h)}}var p=$("rtNotificationsToggle"),r=$("rtNotificationsContainer"),q=$("notificationsDropdown"),
u=$("unreadCount"),t=$("notify-bell"),v=$("mark-all-read"),w=$("markAllHistoryRead"),y=$("notificationHistory"),x=$("historyCount"),z=0,C=document.title;when(v,function(d){d.addEvent("click",l)});when(w,function(d){w.toggleClass("hideThis",0==e());d.addEvent("click",l)});when(p,function(g){Header.setupHeaderDropdown(p,r,{unlock:function(){return 0<e()}});q.addEvent("click:relay(li[data-notificationid] .notification-dismiss)",f);window.addEvent("click:relay(li[data-notificationid])",h);if("undefined"!==
typeof App.socketioRoom){var k=io("wss://realtime.dozuki.com",{transports:["websocket","polling"]});k.on("connect",function(){k.emit("subscribe",{room:App.socketioRoom})});k.on("notification",function(f){switch(f.event){case "notification":d(e()+1);f.contextid===App.contextid&&f.context===App.context&&(document.title="("+ ++z+") "+C);q.appendHTML(f.html,"top");break;case "markRead":m(f.notificationSigs);break;case "markAllRead":m()}})}})}();
(function(){function e(d){f=$E(".js-mini-cart-toggle");g=$E(".js-mini-cart-dropdown");f&&g&&(Header.setupHeaderDropdown(f,g),d())}function d(){Header.toggleHeaderDropdown(g,!1)}var f,g;e(function(){listenGlobal("cart.add",d)});listenGlobal("cart.addcomplete",function(d){f.isVisible()?d&&(html=d.miniCartHtml)&&(when(window.ProductViewPage,function(){ProductViewPage.updateAvailability(d.optionid,d.avail)}),when($("miniCart"),function(d){Elements.from(html).replaces(d);e(function(){TweenLite.to(window,
.5,{scrollTo:0,onComplete:function(){Header.toggleHeaderDropdown(g,!0)}})})})):window.location="/cart/view"})})();
